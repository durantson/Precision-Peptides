<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Molecular Database | Amintex Labs</title>
    
    <meta name="description" content="Interactive 3D molecular visualization engine linked to the NIH PubChem database.">
    <meta name="theme-color" content="#2563eb"> 
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚛️</text></svg>">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=JetBrains+Mono&display=swap" rel="stylesheet">
    <script src="https://3Dmol.org/build/3Dmol-min.js"></script>

    <style>
        body { font-family: 'Inter', sans-serif; }
        .glass-panel { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(12px); border: 1px solid rgba(0,0,0,0.05); }
        .canvas-container { background: radial-gradient(circle at center, #f8fafc 0%, #e2e8f0 100%); }
        .loader { border-top-color: #2563eb; -webkit-animation: spinner 1.5s linear infinite; animation: spinner 1.5s linear infinite; }
        @keyframes spinner { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        /* Mega Menu Transition */
        .tilt-card { transition: transform 0.1s ease-out; }
    </style>
</head>
<body class="bg-slate-50 font-sans antialiased text-slate-900 h-screen flex flex-col overflow-hidden">

    <nav class="bg-white/90 backdrop-blur-xl border-b border-slate-200 h-20 flex items-center px-6 md:px-12 justify-between shrink-0 z-[100]">
        <a href="index.html" class="flex items-center gap-3 hover:opacity-75 transition-opacity z-50">
            <div class="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center text-white shadow-lg shadow-blue-600/20">
                <i class="fas fa-atom text-sm"></i>
            </div>
            <span class="font-black text-xl tracking-tighter uppercase italic text-slate-900">Amintex<span class="text-blue-600">Labs</span></span>
        </a>
        <div class="hidden lg:flex items-center gap-8">
            <div class="group relative py-6"> 
                <button class="flex items-center gap-2 text-[11px] font-black uppercase tracking-[0.15em] text-slate-500 group-hover:text-blue-600 transition-colors">
                    Catalog <i class="fas fa-chevron-down text-[8px] opacity-50"></i>
                </button>
                <div class="absolute top-full -left-10 w-[500px] bg-white border border-slate-100 rounded-2xl shadow-2xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 transform group-hover:translate-y-0 translate-y-2 overflow-hidden">
                    <div class="grid grid-cols-2">
                        <div class="p-6 space-y-1 bg-slate-50/50">
                            <p class="text-[9px] font-bold text-slate-400 uppercase tracking-widest mb-3 ml-2">Categories</p>
                            <a href="catalog.html" class="flex items-center gap-3 p-2 rounded-lg hover:bg-white hover:shadow-sm transition-all group/item">
                                <div class="w-8 h-8 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center"><i class="fas fa-fire"></i></div>
                                <div><div class="text-xs font-bold text-slate-900">Metabolic</div><div class="text-[9px] text-slate-400">GLP-1 & GIP Agonists</div></div>
                            </a>
                            <a href="catalog.html" class="flex items-center gap-3 p-2 rounded-lg hover:bg-white hover:shadow-sm transition-all group/item">
                                <div class="w-8 h-8 rounded-full bg-emerald-100 text-emerald-600 flex items-center justify-center"><i class="fas fa-dna"></i></div>
                                <div><div class="text-xs font-bold text-slate-900">Regenerative</div><div class="text-[9px] text-slate-400">Tissue & Cellular Repair</div></div>
                            </a>
                            <a href="catalog.html" class="flex items-center gap-3 p-2 rounded-lg hover:bg-white hover:shadow-sm transition-all group/item">
                                <div class="w-8 h-8 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center"><i class="fas fa-brain"></i></div>
                                <div><div class="text-xs font-bold text-slate-900">Nootropic</div><div class="text-[9px] text-slate-400">Cognitive Enhancement</div></div>
                            </a>
                        </div>
                        <div class="p-6 bg-slate-900 text-white flex flex-col justify-between">
                            <div>
                                <span class="bg-blue-600 text-white text-[8px] font-bold px-2 py-1 rounded-full uppercase tracking-wide">New Arrival</span>
                                <h4 class="font-black italic text-lg mt-3">Retatrutide</h4>
                                <p class="text-[10px] text-slate-400 mt-1 leading-relaxed">Next-gen triple agonist (GLP-1/GIP/GCGR) now available for synthesis.</p>
                            </div>
                            <a href="catalog.html" class="text-[10px] font-bold uppercase tracking-widest text-blue-400 hover:text-white flex items-center gap-2">View Data <i class="fas fa-arrow-right"></i></a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="group relative py-6">
                <button class="flex items-center gap-2 text-[11px] font-black uppercase tracking-[0.15em] text-slate-500 group-hover:text-blue-600 transition-colors">
                    Resources <i class="fas fa-chevron-down text-[8px] opacity-50"></i>
                </button>
                <div class="absolute top-full left-1/2 -translate-x-1/2 w-64 bg-white border border-slate-100 rounded-2xl shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 transform group-hover:translate-y-0 translate-y-2 p-2">
                    <a href="batch-verification.html" class="flex items-center gap-3 p-3 rounded-xl hover:bg-slate-50 transition-colors"><i class="fas fa-check-circle text-emerald-500"></i><span class="text-xs font-bold text-slate-700">Batch Verification</span></a>
                    <a href="molecular-structures.html" class="flex items-center gap-3 p-3 rounded-xl hover:bg-slate-50 transition-colors"><i class="fas fa-cubes text-blue-500"></i><span class="text-xs font-bold text-slate-700">3D Database</span></a>
                    <a href="support.html" class="flex items-center gap-3 p-3 rounded-xl hover:bg-slate-50 transition-colors"><i class="fas fa-book text-slate-400"></i><span class="text-xs font-bold text-slate-700">Documentation</span></a>
                    <div class="h-px bg-slate-100 my-1"></div>
                    <a href="account.html" class="flex items-center gap-3 p-3 rounded-xl hover:bg-slate-50 transition-colors"><i class="fas fa-user-circle text-slate-900"></i><span class="text-xs font-bold text-slate-700">Client Portal</span></a>
                </div>
            </div>
            <div class="flex items-center gap-2 text-[10px] font-bold text-slate-400 border border-slate-200 px-3 py-1.5 rounded-lg bg-slate-50 cursor-pointer hover:border-blue-400 hover:text-blue-600 transition-all group" onclick="togglePalette()">
                <i class="fas fa-search group-hover:scale-110 transition-transform"></i> <span>CTRL + K</span>
            </div>
        </div>
        <div class="flex items-center gap-6">
            <button onclick="window.location.href='checkout.html'" class="relative group p-2">
                <i class="fas fa-shopping-bag text-slate-900 text-lg group-hover:text-blue-600 transition-colors"></i>
                <span id="cart-badge" class="absolute top-0 right-0 bg-red-500 text-white text-[9px] font-bold w-4 h-4 rounded-full flex items-center justify-center opacity-0 transition-opacity ring-2 ring-white">0</span>
            </button>
            <a href="catalog.html" class="hidden md:block bg-slate-900 text-white px-6 py-2.5 rounded-xl font-bold text-[10px] uppercase tracking-widest hover:bg-blue-600 transition-all shadow-lg shadow-slate-900/20">View Stock</a>
        </div>
    </nav>

    <div class="flex-1 flex relative overflow-hidden">
        
        <aside class="w-80 bg-white border-r border-slate-200 p-6 flex flex-col z-20 shadow-xl overflow-y-auto">
            
            <div class="mb-8">
                <h1 class="text-xl font-black italic uppercase text-slate-900">Structure Viewer</h1>
                <p class="text-[10px] text-slate-400 font-bold uppercase tracking-widest">Powered by PubChem API</p>
            </div>
            
            <div class="space-y-6">
                <div>
                    <label class="text-[10px] font-bold uppercase tracking-widest text-slate-400 mb-2 block">Quick Load Protocol</label>
                    <div class="grid grid-cols-2 gap-2">
                        <button onclick="loadCid(16135327, 'Tirzepatide')" class="px-3 py-2 bg-slate-50 border border-slate-200 rounded text-xs font-bold text-slate-600 hover:border-blue-500 hover:text-blue-600 text-left transition-colors">Tirzepatide</button>
                        <button onclick="loadCid(56843331, 'Semaglutide')" class="px-3 py-2 bg-slate-50 border border-slate-200 rounded text-xs font-bold text-slate-600 hover:border-blue-500 hover:text-blue-600 text-left transition-colors">Semaglutide</button>
                        <button onclick="loadCid(73084, 'GHK-Cu')" class="px-3 py-2 bg-slate-50 border border-slate-200 rounded text-xs font-bold text-slate-600 hover:border-blue-500 hover:text-blue-600 text-left transition-colors">GHK-Cu</button>
                        <button onclick="loadCid(9941957, 'BPC-157')" class="px-3 py-2 bg-slate-50 border border-slate-200 rounded text-xs font-bold text-slate-600 hover:border-blue-500 hover:text-blue-600 text-left transition-colors">BPC-157</button>
                        <button onclick="loadCid(16133171, 'Sermorelin')" class="px-3 py-2 bg-slate-50 border border-slate-200 rounded text-xs font-bold text-slate-600 hover:border-blue-500 hover:text-blue-600 text-left transition-colors">Sermorelin</button>
                        <button onclick="loadCid(439302, 'Oxytocin')" class="px-3 py-2 bg-slate-50 border border-slate-200 rounded text-xs font-bold text-slate-600 hover:border-blue-500 hover:text-blue-600 text-left transition-colors">Oxytocin</button>
                    </div>
                </div>

                <div>
                    <label class="text-[10px] font-bold uppercase tracking-widest text-slate-400 mb-2 block">Import via CID</label>
                    <div class="flex gap-2">
                        <input type="text" id="cidInput" placeholder="e.g. 16135327" class="w-full bg-slate-50 border border-slate-200 rounded px-3 py-2 text-sm font-mono focus:outline-blue-600">
                        <button onclick="manualLoad()" class="bg-slate-900 text-white px-4 rounded text-xs font-bold uppercase hover:bg-blue-600 transition-colors"><i class="fas fa-arrow-right"></i></button>
                    </div>
                </div>

                <div class="border-t border-slate-100 pt-6">
                    <p class="text-[10px] font-bold uppercase tracking-widest text-slate-400 mb-2">Render Style</p>
                    <div class="flex gap-2">
                        <button onclick="setStyle('stick')" class="flex-1 py-2 bg-blue-50 text-blue-600 rounded text-[10px] font-bold uppercase border border-blue-100 hover:bg-blue-100 transition-colors">Stick</button>
                        <button onclick="setStyle('sphere')" class="flex-1 py-2 bg-slate-50 text-slate-500 rounded text-[10px] font-bold uppercase border border-slate-200 hover:bg-slate-100 transition-colors">Sphere</button>
                    </div>
                </div>
            </div>

            <div class="mt-auto pt-6 border-t border-slate-100">
                <div class="bg-emerald-50 border border-emerald-100 p-4 rounded-xl">
                    <div class="flex items-center gap-2 mb-1">
                        <div class="w-2 h-2 bg-emerald-500 rounded-full animate-pulse"></div>
                        <span class="text-[10px] font-bold uppercase text-emerald-600">Live NIH Connection</span>
                    </div>
                    <p class="text-[9px] text-emerald-700/70 leading-relaxed">
                        Data streamed directly from the National Library of Medicine via PubChem PUG REST API.
                    </p>
                </div>
            </div>
        </aside>

        <div id="viewer" class="flex-1 h-full canvas-container relative">
            <div class="absolute top-6 left-6 z-10 glass-panel px-6 py-4 rounded-2xl shadow-lg">
                <div class="flex items-center gap-3 mb-1">
                    <div class="w-2 h-2 rounded-full bg-blue-500 animate-pulse"></div>
                    <h2 id="mol-title" class="text-sm font-black uppercase tracking-widest text-slate-900">System Ready</h2>
                </div>
                <p id="mol-subtitle" class="text-[10px] font-mono text-slate-500 font-bold">Waiting for input...</p>
            </div>
            
            <div id="loader" class="absolute inset-0 flex items-center justify-center bg-white/50 backdrop-blur-sm z-20 hidden">
                <div class="loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-12 w-12 mb-4"></div>
            </div>
        </div>

    </div>

    <script src="inventory.js"></script>
    <script src="godmode.js"></script>

    <script>
        let element = document.getElementById('viewer');
        let viewer = $3Dmol.createViewer(element, { backgroundColor: 'white' });
        let currentStyle = 'stick';

        // Cart Badge Update
        let cart = JSON.parse(localStorage.getItem('precisionCart')) || []; 
        const badge = document.getElementById('cart-badge');
        if(badge) {
            const totalQty = cart.reduce((a,b)=>a+b.qty,0);
            badge.innerText = totalQty;
            badge.style.opacity = totalQty > 0 ? '1' : '0';
        }

        async function loadCid(cid, name) {
            const loader = document.getElementById('loader');
            loader.classList.remove('hidden');
            
            document.getElementById('mol-title').innerText = name || "Loading Structure...";
            document.getElementById('mol-subtitle').innerText = `Fetching CID: ${cid}`;
            
            try {
                const response = await fetch(`https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/${cid}/record/SDF/?record_type=3d`);
                if (!response.ok) throw new Error("Molecule not found");
                
                const data = await response.text();
                viewer.clear();
                viewer.addModel(data, "sdf");
                applyStyle();
                viewer.zoomTo();
                viewer.render();
                viewer.animate({ loop: "forward", step: 0.5 }); 

                document.getElementById('mol-subtitle').innerText = `PubChem CID: ${cid} • Verified`;

            } catch (e) {
                alert("Error loading molecule. CID might be invalid or no 3D data available.");
                document.getElementById('mol-title').innerText = "Error";
            } finally {
                loader.classList.add('hidden');
            }
        }

        function applyStyle() {
            if (currentStyle === 'stick') {
                viewer.setStyle({}, { stick: {radius: 0.2, colorscheme: 'Jmol'} });
            } else {
                viewer.setStyle({}, { sphere: {scale: 0.3, colorscheme: 'Jmol'} });
            }
            viewer.render();
        }

        function setStyle(style) {
            currentStyle = style;
            applyStyle();
        }

        function manualLoad() {
            const cid = document.getElementById('cidInput').value;
            if(cid) loadCid(cid, "Custom Import");
        }

        // Init with GHK-Cu
        loadCid(73084, "GHK-Cu");
    </script>
</body>
</html>
